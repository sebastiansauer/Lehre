---
title: "20260223_25"
format: html
---


Hi there!
Let me jot down some notes...


```{r}
1+1
```

# Import data

```{r}
d <- read.csv("https://vincentarelbundock.github.io/Rdatasets/csv/palmerpenguins/penguins.csv")

head(d)  # see the first few rows, the "head" of the table
```

Import data from your own machine:

Either use the button "import dataset" or use the `read.csv` command.


```{r}
#penguins <- read.csv("~/Downloads/penguins.csv")
```



# Simple model: `y ~ b`

"Y as a function of of a binary input variable (two groups)".

> Is the weight of a penguin a function of the sex of the animal?

Add a code chunk by hitting the button or by typing "Ctr+Alt+I":



```{r}
lm(body_mass_g ~ sex, data = d)
```


## Data preparation

```{r}
library(dplyr)
# library(palmerpenguins)

penguins_filtered <- 
  d %>%
  filter(sex %in% c("male", "female"))
```


Control+Enter -> Run one single line OR the highlighted area



```{r}
library(tidyverse)
penguins_filtered |> 
  count(sex)
```

# Cleaned data



```{r}
lm_weight_sex <- lm(body_mass_g ~ sex, data = penguins_filtered)
```


Visualize the data and the model:

```{r}
library(tidyverse)
library(ggpubr)
```


```{r}
ggdotplot(penguins_filtered,
          x = "sex",
          y = "body_mass_g",
          add = "mean")
```

Quality of the model, "goodness" of fit:

```{r}
library(easystats)
```

`r2` gives you the R-Squared:

```{r}
r2(lm_weight_sex)
```


# `y ~ x`

DV: y (metric)
IV: x (metric)

Research question: 

> body mass as a function flipper length


```{r}
lm_weight_flipper <-
  lm(body_mass_g ~ flipper_length_mm, data = penguins_filtered)
```


```{r}
parameters(lm_weight_flipper)  # from package "easystats"
```

```{r}
ggscatter(data = penguins_filtered,
          x = "flipper_length_mm",
          y = "body_mass_g",
          add = "reg.line")
```

```{r}
r2(lm_weight_flipper)
```

## Exr

RQ: body_mass_g as a function of bill length? What's the (statistical) effect of bill length of body weight?

Please report:

- the effect of bill length
- goodness of the model



```{r}
lm_bill <- lm(body_mass_g ~ bill_length_mm, data = penguins_filtered)

summary(lm_bill)

ggscatter(data = penguins_filtered, x = "bill_length_mm", y = "body_mass_g", add = "reg.line")

parameters(lm_bill)

r2(lm_bill)
```


Make a nice table in html/pdf/word:


```{r}
parameters(lm_bill) |> print_md()
```



# Next typical linear model: `y ~ x + g`


RQ: weight influenced by species and by flipper length?

**Interaction, moderation**


```{r}
lm_y_by_x_and_g <-
  lm(body_mass_g ~ flipper_length_mm + species + flipper_length_mm:species, data = penguins_filtered)

parameters(lm_y_by_x_and_g)
```


```{r}
ggscatter(penguins_filtered,
          x = "flipper_length_mm",
          y = "body_mass_g",
          color = "species",
          add = "reg.line")
```

## Exr:

RQ: Assocation between weight and bill length also depends on the sex of the animals?


```{r}
lm_weigth_by_bill_sex <-
  lm(body_mass_g ~ bill_length_mm + sex + bill_length_mm:sex, data = penguins_filtered)

parameters(lm_weigth_by_bill_sex)
```


```{r}
ggscatter(penguins_filtered,
          x = "bill_length_mm",
          y = "body_mass_g",
          color = "sex",
          add = "reg.line")
```

```{r}
r2(lm_weigth_by_bill_sex)
```

