---
title: "2025-02-27"
format: html
---


# Setup

Hit Shift-Command-Enter to run a whole code chunk.

```{r}
library(tidyverse)
library(easystats)
library(ggpubr)
library(rstanarm)
```



# A simple linear model

Research question: 

>   Is fuel economy a function of horse power of a car?

hp --> mpg


```{r}
lm1_freq <- lm(mpg ~ hp, data = mtcars)
```

Here are the results (parameters):

```{r}
parameters(lm1_freq)
```

ex: scatterplot with a regression line for this model.


```{r}
ggscatter(mtcars,
          y = "mpg",
          x = "hp",
          add = "reg.line",
          conf.int = TRUE,
          ellipse = TRUE,
          cor.coef = TRUE) +
  scale_color_okabeito()
```



# Bayes model1

```{r}
lm1_bayes <- stan_glm(mpg ~ hp, data = mtcars)  # rstanarm
parameters(lm1_bayes)
```


# Exercise


Penguins: 

Research Question: Whether the bill length is a predictor of weight.


## Data

```{r}
penguins <- read.csv("https://vincentarelbundock.github.io/Rdatasets/csv/palmerpenguins/penguins.csv")
```


## Model

```{r}
lm_peng1 <- stan_glm(body_mass_g ~ bill_length_mm,
                     data = penguins,
                     refresh = 0)
parameters(lm_peng1)
```

```{r}
plot(parameters(lm_peng1))
```


```{r}
ggscatter(penguins,
          x = "bill_length_mm",
          y = "body_mass_g",
          add = "reg.line")
```


```{r}
r2(lm_peng1)
```


# Models with a nominal X (two groups)

**t-test**

```{r}
#| eval: false
t.test(y ~ x, data = my_data)
```


Research Question: Sex has an effect on weight

Sex --> Weight

```{r}
penguins_nona <-
  penguins |> 
  filter(sex != "") |> 
  drop_na()
```



```{r}
lm_peng2 <- stan_glm(body_mass_g ~ sex, data = penguins_nona,
                     refresh = 0)
parameters(lm_peng2)
```

```{r}
ggscatter(penguins_nona,
          x = "sex",
          y = "body_mass_g",
          add = "reg.line")
```

```{r}
ggboxplot(penguins_nona,
          x = "sex",
          y = "body_mass_g",
          add = "mean_se")
```



```{r}
estimate_relation(lm_peng2) |> plot()
```


# Metric Y, nominal X (with more than 2 values)


Research question:

>   Whether species are different in terms of weight (on average)?

Research question more precise:

$\mu_1 = \mu_2 = \mu_3$


```{r}
lm_peng3 <- lm(body_mass_g ~ species, data = penguins_nona)
parameters(lm_peng3)
```

```{r}
plot(parameters(lm_peng3))
```


```{r}
ggboxplot(penguins_nona,
          x = "species",
          y = "body_mass_g",
          add = "mean_se")
```


```{r}
estimate_relation(lm_peng3) |> plot()
```


```{r}
r2(lm_peng3)
```


